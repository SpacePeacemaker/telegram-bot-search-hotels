<h1 align="center">Поиск отелей на сайте hotels.com

[![Telegram URL](https://www.dampftbeidir.de/mediafiles/tpl/icon-telegram.png)](https://t.me/borisov_search_hotels_bot) 
</h1>

***

## Краткое описание

С помощью данного [телеграм-бота](@borisov_search_hotels_bot) можно найти различные варианты отелей на сайте [hotels.com](https://hotels.com/).
<br> Пользователь с помощью команд бота может выполнить следующие действия: <br/>
- Найти самые дешёвые отели в нужном городе (**команда /lowprice**); 
- Найти самые дорогие отели в нужном городе (**команда /highprice**); 
- Найти отели, наиболее подходящие по цене и расположению от центра города (**команда /bestdeal**); 
- Узнать свою историю поиска отелей (**команда /history**).


**Этот бот был разработан с помощью открытого [API Hotels](https://rapidapi.com/apidojo/api/hotels4/).**

***

## Локальная установка
Эти инструкции помогут вам развернуть проект на локальном компьютере для разработки и тестирования.

**Перед тем, как начать:**
- Если вы не пользуетесь `Python 3`, необходимо установить инструмент `virtualenv` при помощи команды в терминале `pip install virtualenv`. 
Если вы используете `Python 3`, у вас уже установлен модуль [venv](https://docs.python.org/3/library/venv.html) в стандартной библиотеке.

### Запуск проекта (на примере Windows)

- Создайте на своём компютере папку проекта
- Склонируйте этот репозиторий в папку проекта `https://gitlab.skillbox.ru/borisov_dmitrii/python_basic_diploma.git`
- Создайте файл `.env` и добавьте в него переменные окружения, следующего вида:
<br><br>
    BOT_TOKEN= "ваш бот токен"<br>
    RAPID_API_KEY= "ваш rapid_api key"<br>
<br>
- Активируйте виртуальное окружение `pipenv shell`
- Установите все зависимости `pipenv install --ignore-Pipfile`
- Запустите бота командой `pipenv run main.py` из Терминала из папки с проектом 

***

## Описание работы команд

### Команда /start

Выводится приветствие пользователю. Бот умеет определять, работал ли с ним пользователь или же нет.

### Команда /help

Выводится список всех команд и их краткое описание.

### Команды /lowprice и /highprice

1. У пользователя запрашивается город, в котором будет проводиться поиск отелей;
2. Выдаётся список возможных вариантов городов, пользователь выбирает нужный ему вариант;
3. У пользователя запрашивается количество взрослых гостей (не больше 5 человек);
4. У пользователя запрашивается количество детей (не больше 5 человек). Если пользователь ввёл какое-то число детей, то бот будет запрашивать возраст каждого ребёнка (от 1 года до 17 лет);
5. У пользователя запрашивается количество отелей, которые необходимо вывести в результате работы бота (не больше 10 отелей);
6. Пользователь с помощью календаря выбирает дату заезда и выезда;
7. У пользователя запрашивается необходимость в просмотре фотографий отеля. Если пользователь выбрал, что ему нужны фотографии, то бот запросит у пользователя количество фотографий для просмотра (не больше 5 фотографий);
8. После опроса пользователь нажимает кнопку "Начать поиск отелей". Бот ищет подходящие отели и выводит их в виде списка. После этого пользователь выбирает самый подходящий на его взгляд отель;
9. Бот ищет детальную информацию по выбранному отелю и отправляет её пользователю.

### Команда /bestdeal

1. У пользователя запрашивается город, в котором будет проводиться поиск отелей;
2. Выдаётся список возможных вариантов городов, пользователь выбирает нужный ему вариант;
3. У пользователя запрашивается количество взрослых гостей (не больше 5 человек);
4. У пользователя запрашивается количество детей (не больше 5 человек). Если пользователь ввёл какое-то число детей, то бот будет запрашивать возраст каждого ребёнка (от 1 года до 17 лет);
5. У пользователя запрашивается минимально и максимально допустимая стоимость пребывания в отеле (в долларах США);
6. У пользователя запрашивается минимальное и максимальное расстояние отеля от центра города (в километрах);
7. У пользователя запрашивается количество отелей, которые необходимо вывести в результате работы бота (не больше 10 отелей);
8. Пользователь с помощью календаря выбирает дату заезда и выезда;
9. У пользователя запрашивается необходимость в просмотре фотографий отеля. Если пользователь выбрал, что ему нужны фотографии, то бот запросит у пользователя количество фотографий для просмотра (не больше 5 фотографий); 
10. После опроса пользователь нажимает кнопку "Начать поиск отелей". Бот ищет подходящие отели и выводит их в виде списка. После этого пользователь выбирает самый подходящий на его взгляд отель; 
11. Бот ищет детальную информацию по выбранному отелю и отправляет её пользователю.

### Команда /history

1. Выдает список выполненных пользователем запросом, но не более 5
2. Дату и время ввода команды
3. То слово (город), по которому пользователь искал отели
4. Если пользователю фотографии были не нужны, то они выведены не будут


## Описание внешнего вида и UI
Окно Telegram-бота при запущенном Python-скрипте воспринимает следующие команды:
- /start - запуск бота
- /help — помощь по командам бота 
- /lowprice — вывод самых дешёвых отелей в городе
- /highprice — вывод самых дорогих отелей в городе 
- /bestdeal — вывод отелей, наиболее подходящих по цене и расположению от центра города
- /history — вывод истории поиска отелей

Для команд lowprice, highprice и bestdeal сообщение с информацией по выбранному отелю:
- Количество взрослых и детей;
- Город;
- Название отеля;
- Его адрес;
- Даты заезда и выезда;
- Цена за ночь и общая стоимость за всю поездку (в долларах США);
- Расстояние от отеля до центра города (в километрах);
- Ссылка на страницу отеля на сайте [hotels.com](https://hotels.com/);
- Фотографии отеля (если пользователь счёл необходимым их вывод).

Если отель по заданным критериям не был найден, то в последнем сообщении с информацией в названии отеля будет фраза "Не найдено!", а поля с адресом, ценами, расстоянием до центра города, ссылкой и фотографии (если они были выбраны для просмотра) будут отсутствовать.

## Python-библиотеки, использованные для разработки telegram-бота:

certifi==2022.6.15<br>
charset-normalizer==2.1.1<br>
colorama==0.4.5<br>
idna==3.3<br>
loguru==0.6.0<br>
pyTelegramBotAPI==4.11.0<br>
python-dateutil==2.8.2<br>
python-dotenv==0.19.2<br>
python-telegram-bot-calendar==1.0.5<br>
requests==2.28.1<br>
six==1.16.0<br>
urllib3==1.26.12<br>
win32-setctime==1.1.0<br>
peewee==3.16.2
